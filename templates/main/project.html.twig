{% extends 'main/parent.html.twig' %}

{% block stylesheets %}
    <link href="{{ asset('web/styles/profile.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ asset('web/styles/style.css') }}" rel="stylesheet" type="text/css"/>
    <script src="{{ asset('web/scripts/jquery-3.4.1.min.js') }}"></script>
{% endblock %}



{% block body %}



    <div id="profile">
        <div class="profile-left">
            <img id="profile-picture" src="data:image/jpeg;base64,{{ photo_data_provider.getPhotoByProjectTitle(project.title) }}" width="230" height="280">
        </div>

        <div class="profile-right">
            <p id="name-profile">{{ project.title }}
                {% if isAuthor %}
                <button class="navico message-ico"><i class="fa fa-pencil"></i></button> {# edycja #}
                {% endif %}
            </p>


            <p class="infos">TECHNOLOGIE</p>
            {% for technology in project.technology %}
                {% if not loop.last %}
                    {{ technology.name }},
                {% else %}
                    {{ technology.name }}
                {% endif %}
            {% endfor %}
            <hr>


            <p class="infos">CZŁONKOWIE</p>
            {% for user in project.user %}
                {% if not loop.last %}
                    {{ user.firstname }} ({{user.username}}) {{ user.lastname }},
                {% else %}
                    {{ user.firstname }} ({{user.username}}) {{ user.lastname }}
                {% endif %}
            {% endfor %}
            <hr>


            <p>{{project.description}}</p>
        </div>
    </div>
    {% if not isMember %}
    <div id="mess">
        <button class="navico message-ico"><i class="fa fa-envelope"></i></button> {# wyslij wiadomosc #}

        <button class="navico message-ico"><i class="fa fa-user-plus"></i></button> {# popros o dodanie #}

    </div>
    {% endif %}
    {% if isMember %}
    <div class="form-post">
        <img id="post-avatar"  src="data:image/jpeg;base64,{{ photo_data_provider.getCurrentUserPhotoData() }}" width="70" height="70">
        <form action="{{ path('create_wall_post') }}" method="post">

            <div class="photo-textarea">
                <textarea name="text" class="form-control" rows="5" cols="25"></textarea>

                <input type="hidden" name="username" value={{ app.user.username }}>

                <button style="display:none;" id="file-cancel"></button>
                <label>
                    <input type="file" id="add-image" accept="image/jpeg, image/png" class="fileToUpload"
                           style="display:none;"/>
                    <span><i class="fa fa-image"></i></span>
                </label>


                <input type="submit" id="button-rem" class="button-post" value="Opublikuj"></div>
            <br>

        </form>
    </div>
    {% endif %}

    {# nie wiem do końca kto moze komentować projekty xD #}
    {#  {% for post in posts %}
          <div class="comment">
              <a href="{{ path('user_profile', {'username': user.username}) }}"><img id="comment-avatar" src="data:image/jpeg;base64,{{ img }}" width="70" height="70"></a>

              <p class="project-title" href="{{ path('user_profile', {'username': user.username}) }} ">{{ user.firstname }} {{ user.lastname }}</p> ✽ {{ post.timestamp.format('Y-m-d H:i:s') }}
              <p class="comment-content">{{  post.text}}</p>
          </div>
      {% endfor %} #}


    <script>
        $(document).ready(function () {


            //////////////photo preview
            function readURL(input) {

                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    var filename = (input.files[0].name);

                    reader.onload = function (e) {
                        $('#file-cancel').html(filename + " x");
                        $('#file-cancel').show();
                    }

                    reader.readAsDataURL(input.files[0]);
                }
            }

            $("#add-image").change(function () {
                readURL(this);
            });
            /////////////////

            $("#file-cancel").on("click", function () {
                event.preventDefault();
                $('#add-image').val("");
                $('#file-cancel').hide();
            });


        });
    </script>



{% endblock %}